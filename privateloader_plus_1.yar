rule composite_hex_1 {
    meta:
        author = "Jenson Goh"
        date = "2025-10-29"
        impact = "Matching binaries: 8"
        hash = "0306778313b74289e440495de6de20e2d26452d9dd82451303d3441f16f8c66f"
        hash = "22275b7c5a57111aca919f6bbfae171e5e99f5ef777d1043802deb672f5136a0"
        hash = "3bd8e0efe68826f448c82133ed2115d8752cdc119fe6d3861d2afb6e8a9442f1"
        hash = "afa631b0721ed1e0f22d8464b19c2571859b470f17d9c04e03f80d1c62fbc5d2"
        hash = "b2aefe9f49a84f067eded0c993c3cb5acf3504d29a978de02f9c1592f6e1f15b"
        hash = "ba1d5e82bf560f617d718f6e680b4655b88952251891175e828122390879266f"
        hash = "ba6b18f6a7590ec1dc2ac2881ddc857f505fed25ff29dc761e204538e3feb96d"
        hash = "ffb7eb4d41dc3309a61521f921834d31272477fcd2996679a698b672d70aa91e"
    strings:
        $str_1 = { 83c418c3909090908b4424088b4c2404 }
        $str_2 = { 5e5fc39090909090909090909090568b }
    condition:
        uint16(0) == 0x5a4d
        and all of them
}

rule composite_hex_2 {
    meta:
        author = "Jenson Goh"
        date = "2025-10-29"
        impact = "Matching binaries: 6"
        hash = "0e9c03950018bd67fbe0392aee240ab7bb8cf10d2b42331d382d29be1a2d224e"
        hash = "1af55649a731abb95d71e2e49693a7bcf87270eb4f8712b747f7e04a0a2a3031"
        hash = "27c1ed01c767f504642801a7e7a7de8d87dbc87dee88fbc5f6adb99f069afde4"
        hash = "34e24894195e65efb48664d598d305868f65db91ed773ba34a35df6228488ab3"
        hash = "4b51c393104af7970c54b872bc91f1af6b89457e49f6d6df2c917e0111a18738"
        hash = "75efe0186f34fcd3d39f462f3ab89a029722a6cd6b669a20a70c8ea43afb99f2"
    strings:
        $str_1 = { 0020005300610066006100720069002f003500330037002e003300360000 }
        $str_2 = { 0000002d0032004c0000002d0031004c000000 }
    condition:
        uint16(0) == 0x5a4d
        and all of them
}

rule composite_hex_3 {
    meta:
        author = "Jenson Goh"
        date = "2025-10-29"
        impact = "Matching binaries: 3"
        hash = "3eee4e0b43f4a4d73400e21a5b939375776b724682933235618a8a3c0520de7e"
        hash = "9cedfae4ace54a670cb96ebd5ba37c0d844562b29f654cd1ed10333fab5baab2"
        hash = "de3e916b84e5baab191cb54d4e9d810e513939736d5e1b7b43ce54bba7cde10c"
    strings:
        $str_1 = { 8100e134efc6c3cccccccccccccccccc }
        $str_2 = { 0000000000000000000000000000000000000000000000000000000000000000699af974 }
        $str_3 = { 00f2160b680000000000000000000000000000000000000000000000000000000000000000 }
        $str_4 = { 96aacb46000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 }
        $str_5 = { 0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000094488d6a }
    condition:
        uint16(0) == 0x5a4d
        and 3 of them
}

rule composite_hex_4 {
    meta:
        author = "Jenson Goh"
        date = "2025-10-29"
        impact = "Matching binaries: 2"
        hash = "dbd6fcf0495ae49cef1cf8b2f65f0cdcc16b0c4421f60ec88b8922f18aef1dc9"
        hash = "f786588c51e901108f3e953587a806d0b522d86dc9383831c4b1316069c51a8d"
        str_1_ascii = "`A_A^A]A\\_^]"
        str_4_ascii = "RtlUnwindEx"
        str_4_ascii = "InterlockedFlushSList"
        str_4_ascii = "SetLastError"
        str_5_ascii = "x ATAVAWH"
        str_13_ascii = "A_A^A]A\\_^]"
    strings:
        $str_1 = { ffff832000e985fdffff8b45e42bc3eb0233c0488b9c24b80000004883c460415f415e415d415c5f5e5dc3cc48895c24084889742410574883ec20 }
        $str_2 = { ffff488bf84885c0742e4c89742438448bce4c897424304c8bc3896c242833d233c94889442420e897feffff85c07408488bf7498bfeeb03498bf6488bcfe8 }
        $str_3 = { 0000e96affffff4e8d04f8488bd3488d4548488bce4c8d4d404889442420e8f7fcffff4183fe0175168b4540ffc848891d05 }
        $str_4 = { 00e20452746c556e77696e644578007303496e7465726c6f636b6564466c757368534c6973740041055365744c6173744572726f720000 }
        $str_5 = { 00c3cc488bc4488958084889681048897018488978204154415641574883ec204c8b7c24604d8be1498bd84c8bf2488bf94983270049c701010000004885d2740748891a4983c6084032ed803f22750f4084ed40b622400f94c548ffc7eb3749ff074885db74078a07880348ffc30fbe3748ffc78bcee8 }
        $str_6 = { 0000b001c3cc48895c24084889742410574883ec20488bf2488bf9483bca7454488bd9488b034885c0740aff15f9 }
        $str_7 = { 000085c0750d83fb0174088d4803e8c1feffff488b9c24d00500004881c4c00500005dc3 }
        $str_8 = { 00b0014883c428c3cccccc81f935c4000077208d81d43bffff83f809770c41baa7020000410fa3c2720583f92a752f33d2eb2b81f998d60000742081f9a9de0000761b81f9b3de000076e481f9e8fd000074dc81f9e9fd0000750383e20848ff25c2 }
        $str_9 = { cc48895c240848896c24104889742418574883ec5033ed498bf0488bfa488bd94885d20f84380100004d85c00f842f01000040382a75114885c90f8428010000668929e920010000498bd1488d4c2430e874 }
        $str_10 = { 0000488b5c243048f7df481bc04823c6488b7424384883c4205fc34883ec28488d0de9fbffffe8 }
        $str_11 = { 000084c074094883c310483bde75e5483bde7431483bdf74284883c3f848837bf8007410488b034885c0740833c9ff15c7 }
        $str_12 = { 00004533f6488bd84885c00f84a4000000488bf066443930741c4883c8ff48ffc0664439344675f6488d34464883c6026644393675e44c89742438482bf34c897424304883c60248d1fe4c8bc3448bce448974242833d24c8974242033c9e8d0feffff4863e885c0744b488bcde8 }
        $str_13 = { 488b9c24880300004881c430030000415f415e415d415c5f5e5dc3cccce957f9ffffcccccc48895c2408 }
        $str_14 = { 00004883eb10488d4308483bc775dc32c0eb02b001488b5c2430488b7424384883c4205fc348895c2408574883ec20488bda488bf9483bca741a488b43f84885c0740833c9ff157e }
        $str_15 = { 0075ee32c04883c428c3b001ebf7cccccc4883ec2885c97507c605 }
    condition:
        uint16(0) == 0x5a4d
        and 10 of them
}

rule composite_hex_5 {
    meta:
        author = "Jenson Goh"
        date = "2025-10-29"
        impact = "Matching binaries: 2"
        hash = "db73090514ac448cc67c0f8a7b614b52006bbe3a2e1b3a47b65fc8b3e794a39a"
        hash = "e5515aa3c0119cc48a6ba1a473f871ed44e8224609ca561cfe1e569fcfbeb443"
    strings:
        $str_1 = { c22000558bec837d08008b550c568bf1750c8bc20b451075056a0459eb0233c9837e4c0074278d04125051ff7508ff764ce8 }
        $str_2 = { 00ff5e5dc38bff558bec568b750c85f6741f8b450885c074183bc67414576a2e598bf8f3a583600c0050e8be }
        $str_3 = { ff668bc65ec9c38bff558bec8b4d0c8b410483c0023901731183790800753183791802722b89018b4d0c8b410c5657908b39668b5508c1e80c8d77fe8931 }
        $str_4 = { 558bec51515356578bf98b571c8d473c3902751a837d14017514837f3800750e8b750c8b5d1083c6fe83d3ffeb068b5d108b750c837f4c007466e8 }
        $str_5 = { 008bd833c0663904737d188bd68bc6c1ea0383e0070fb64c3a0c0fabc133c0884c3a0c4681fe000100007cd95b8bc75f5e5dc3558bec518b45148b4d085633f63970087415668b450cbaff000000663bc2772b880133c040eb328d55fc8975fc5256ff7004516a018d4d0c5156ff30ff1574 }
        $str_6 = { 6a0c5e8930eb2f8d45f4508d45fc508b45fc8d0486505653e88100000083c41483ff01751c8b45fc48893544 }
        $str_7 = { 008bcfffd633c92bc1741f83e801741d4883e801753d884b3eb0018b4dfc5f5e33cd5be8 }
        $str_8 = { 0000cc558bec83ec38538b5d08813b030000800f84170100005657e8c2f8ffff33ff397808744657ff1580 }
        $str_9 = { 000083c41085c075798b55f0eb0c6a025a885df4887df58955f08b450c8b480403ca390873138378080075563b50187f5189088b450c8b55f08d72ff85f678158a4c35f4ff0883ee018b0088088b450c79ee8b55f00150088b450c6af75983c00cf021088b4d0c33c04083c10cf00901668bc78b4dfc5f5e33cd5be8 }
        $str_10 = { ffff32c0c3b001c38bff558bec33d2391175208b4508505252525252c6401c01c7401816000000e8 }
        $str_11 = { c9c3884b3e8b75d88d45dc2bf07413ff734c566a0150e8 }
        $str_12 = { 0033c58945fc538bd95657837b3800745a807b3e0074548b03bfffff0000578b700c8bceff15 }
        $str_13 = { 01741566391674138939b8ffff0000eb2cb8ffff00005dc36689168b450c6af759834008028b450c83c00cf021088b4d0c33c04083c10cf00901668bc25f5e5dc38bff558bec83ec }
        $str_14 = { c38bff558bec837d1800750b8b450c8038350f9dc05dc3e803 }
        $str_15 = { ffc9c3b8ffff0000ebea8bff558bec56beffff000057663975080f84990000008b7d0c8b470c908b570c908b4f0c90a801750fc1ea02f6c201747ed1e9f6c1017577837f0400750757e8 }
    condition:
        uint16(0) == 0x5a4d
        and 10 of them
}

rule composite_hex_6 {
    meta:
        author = "Jenson Goh"
        date = "2025-10-29"
        impact = "Matching binaries: 2"
        hash = "691f866dcf8672a185591df3654e1023bf55156531bb957ebf2d01b38adccd9a"
        hash = "e677c3c4f4a0cac9155eab1b42732004b2f48da7571e432b56498feb1d74aecc"
    strings:
        $str_1 = { 0250d2ca05b8a5b50ca0c8481ac093d3 }
        $str_2 = { 504500004c010500e2608d620000000000000000e00002010b010e0d0064000000 }
        $str_3 = { 00007c0000000000000000000000000000400000402e72656c6f6300008808000000 }
        $str_4 = { 0000000000606a000000100000008000000000400000100000000200000a0000000a000000060000000000000000 }
        $str_5 = { 008808000010140000540000000000000000000000000000000000000000000000000000000810000040000000000000000000000000a00000880200000000000000000000000000000000000000000000000000002e7465787400000014630000001000000064000000040000000000000000000000000000200000602e64617461000000481a0000008000000002000000680000000000000000000000000000400000c02e696461746100005210000000a0000000120000006a0000000000000000000000000000400000402e7273726300000000 }
    condition:
        uint16(0) == 0x5a4d
        and 3 of them
}

rule composite_hex_7 {
    meta:
        author = "Jenson Goh"
        date = "2025-10-29"
        impact = "Matching binaries: 1"
        hash = "d4504224ca04a6dd109f2d20ac67bc766801aef55329e7840fb4a2b655cc1db9"
    strings:
        $str_1 = { 0c00000033c94885c0488d6424080f84 }
        $str_2 = { e900000000c34881ec38010000488d442420 }
        $str_3 = { 32042ae9000000008802e9000000000f84 }
        $str_4 = { 000004000000040000000000000000000000000000400000c02e }
        $str_5 = { 400100000000000000000000000000000000003000 }
    condition:
        uint16(0) == 0x5a4d
        and 3 of them
}

rule composite_hex_8 {
    meta:
        author = "Jenson Goh"
        date = "2025-10-29"
        impact = "Matching binaries: 1"
        hash = "d20ae7125575c73a3b58338f11d77b67c254eb6abab468f95a3d2bf09f87b369"
        str_1_ascii = "GetLastError"
    strings:
        $str_1 = { 00004765744c6173744572726f7200488b }
        $str_2 = { e900000000c34881ec38010000488d442420 }
        $str_3 = { 32042ae9000000008802e9000000000f84 }
        $str_4 = { 400100000000000000000000000000000000003000 }
    condition:
        uint16(0) == 0x5a4d
        and all of them
}

rule composite_hex_9 {
    meta:
        author = "Jenson Goh"
        date = "2025-10-29"
        impact = "Matching binaries: 1"
        hash = "1279459048fee6a5e9d8689699a436e83f972a25dc2d1fd483aeaee301399969"
        str_1_ascii = "A_A^A]A\\_^]"
    strings:
        $str_1 = { 488b9c24880300004881c430030000415f415e415d415c5f5e5dc3cccce957f9ffffcccccc48895c2408 }
        $str_2 = { 0000ebeab0014883c428c3cccc40534883ec20803d }
        $str_3 = { cccccccccccccccccccccccccccccccccc66660f1f840000000000482bd14d85c0746af7c107000000741d0fb6013a040a755d48ffc149ffc8745284c0744e48f7c10700000075e349bb808080808080808049bafffefefefefefefe8d040a25ff0f00003df80f000077c0488b01483b040a75b74883c1084983e808760f4d8d0c0248f7d04923c14985c374cf33c0c3481bc04883c801c3cccccc4d85c0751833c0c30fb7016685c07413663b02750e4883c1024883c2024983e80175e50fb7010fb70a2bc1c348895c24084c894c2420574883ec20498bd9498bf88b0ae8 }
        $str_4 = { 0020005300610066006100720069002f003500330037002e003300360000 }
    condition:
        uint16(0) == 0x5a4d
        and all of them
}

rule composite_hex_10 {
    meta:
        author = "Jenson Goh"
        date = "2025-10-29"
        impact = "Matching binaries: 1"
        hash = "8c318c16c714156084fdcfc074c61b4be3b8b6386bfb2bf4399d6da551d2d0c1"
        str_2_ascii = "GetLastError"
    strings:
        $str_1 = { 0c00000033c94885c0488d6424080f84 }
        $str_2 = { 00004765744c6173744572726f7200488b }
        $str_3 = { 000004000000040000000000000000000000000000400000c02e }
    condition:
        uint16(0) == 0x5a4d
        and all of them
}

rule composite_hex_11 {
    meta:
        author = "Jenson Goh"
        date = "2025-10-29"
        impact = "Matching binaries: 1"
        hash = "bbf8dbb3ca59a60f20438cabbb16449bdecbfa4c6347172a6e20c3639dd4e2fd"
        str_1_ascii = "GetConsoleAliasExesLengthW"
    strings:
        $str_1 = { 00007c01476574436f6e736f6c65416c696173457865734c656e677468570000 }
        $str_2 = { 010000010053007400720069006e006700460069006c00650049006e0066006f0072006d000000 }
    condition:
        uint16(0) == 0x5a4d
        and all of them
}

rule composite_hex_12 {
    meta:
        author = "Jenson Goh"
        date = "2025-10-29"
        impact = "Matching binaries: 1"
        hash = "b6c1b7f1121a2e9829367ae02826c2af2efd830dbdefaa1765647ad07799d517"
        str_1_ascii = "GetConsoleAliasExesLengthW"
        str_2_ascii = "  </trustInfo>"
        str_2_ascii = "</assembly>"
        str_2_ascii = "  <trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\">"
        str_2_ascii = "      </requestedPrivileges>"
        str_2_ascii = "<assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\">"
        str_2_ascii = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>"
        str_2_ascii = "    <security>"
        str_2_ascii = "    </security>"
        str_2_ascii = "        <requestedExecutionLevel level=\"requireAdministrator\" uiAccess=\"false\"></requestedExecutionLevel>"
        str_2_ascii = "      <requestedPrivileges>"
    strings:
        $str_1 = { 00007c01476574436f6e736f6c65416c696173457865734c656e677468570000 }
        $str_2 = { efbbbf3c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d3822207374616e64616c6f6e653d22796573223f3e0d0a3c617373656d626c7920786d6c6e733d2275726e3a736368656d61732d6d6963726f736f66742d636f6d3a61736d2e763122206d616e696665737456657273696f6e3d22312e30223e0d0a20203c7472757374496e666f20786d6c6e733d2275726e3a736368656d61732d6d6963726f736f66742d636f6d3a61736d2e7633223e0d0a202020203c73656375726974793e0d0a2020202020203c72657175657374656450726976696c656765733e0d0a20202020202020203c726571756573746564457865637574696f6e4c6576656c206c6576656c3d227265717569726541646d696e6973747261746f72222075694163636573733d2266616c7365223e3c2f726571756573746564457865637574696f6e4c6576656c3e0d0a2020202020203c2f72657175657374656450726976696c656765733e0d0a202020203c2f73656375726974793e0d0a20203c2f7472757374496e666f3e0d0a3c2f617373656d626c793e0000000000000000000000000000000000000000 }
    condition:
        uint16(0) == 0x5a4d
        and all of them
}

rule atomic_hex_1 {
    meta:
        author = "Jenson Goh"
        date = "2025-10-29"
        impact = "Matching binaries: 7"
        hash = "34e24894195e65efb48664d598d305868f65db91ed773ba34a35df6228488ab3"
        hash = "27c1ed01c767f504642801a7e7a7de8d87dbc87dee88fbc5f6adb99f069afde4"
        hash = "0e9c03950018bd67fbe0392aee240ab7bb8cf10d2b42331d382d29be1a2d224e"
        hash = "a206d34bbfb7274775956f308ae81339a673c0e894ed55ee1e8e0f01f20ba5fb"
        hash = "1af55649a731abb95d71e2e49693a7bcf87270eb4f8712b747f7e04a0a2a3031"
        hash = "4b51c393104af7970c54b872bc91f1af6b89457e49f6d6df2c917e0111a18738"
        hash = "c745b20ead6a3cfceaf54c906388764bd0f2eaf7782063dc646c47bab9deac26"
        string_ascii = "abcdefghijklmnopqrstuvwxyz0123456789_ABCDEFGHIJKLMNOPQRSTUVWXYZ"
    strings:
        $str = { 0000006162636465666768696a6b6c6d6e6f707172737475767778797a303132333435363738395f4142434445464748494a4b4c4d4e4f505152535455565758595a00 }
    condition:
        uint16(0) == 0x5a4d
        and $str
}

rule atomic_hex_2 {
    meta:
        author = "Jenson Goh"
        date = "2025-10-29"
        impact = "Matching binaries: 7"
        hash = "1eb3574e7faa18d12759034dcc5a26ac90d79badef17cf1a744854d9a9e41cb0"
        hash = "e6ea98b046b11a35efa0ac1243f6190ff4d4247a35784e65a9feaaf4918ae779"
        hash = "4c77fe5f681d599b9897ba7cb421e0ae34badb3581e7c3c62ec72cb6b22b911f"
        hash = "8f9cdf75c272fda7df367232756ea065600077804b16506ee5a4203571328217"
        hash = "b1c6fbded2b0c02a726f716dc54aea0a9fb79ec14dd60120705ae4d19e1a3d94"
        hash = "c9de02209482359466292be7bc0464fc65037698b38c1566cd331720e65f8ea0"
        hash = "e885de8b762310ee43422ad337003e6905c79931803f38d7a7d8ca90e2f8aa74"
    strings:
        $str = { 057c17c3be74b0504180cdcd704539dde92fa758ae79 }
    condition:
        uint16(0) == 0x5a4d
        and $str
}

rule atomic_hex_3 {
    meta:
        author = "Jenson Goh"
        date = "2025-10-29"
        impact = "Matching binaries: 4"
        hash = "f898864731b75798f805346f21c714c66464b061055e4cf60443e54a9a475fb8"
        hash = "27c1ed01c767f504642801a7e7a7de8d87dbc87dee88fbc5f6adb99f069afde4"
        hash = "de3e916b84e5baab191cb54d4e9d810e513939736d5e1b7b43ce54bba7cde10c"
        hash = "0b4ca50978ff2bacd006e8a9012d4eccdc5de68e14a3ae4c1d5b6a6a2909622c"
    strings:
        $str = { 00000043006f007000790072006900670068007400200028004300290020003200300032003200 }
    condition:
        uint16(0) == 0x5a4d
        and $str
}